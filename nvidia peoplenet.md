# NVIDIA PeopleNet 초보자 가이드

## 📖 목차
1. [PeopleNet이란 무엇인가요?](#peoplenet이란-무엇인가요)
2. [주요 기능과 활용 분야](#주요-기능과-활용-분야)
3. [기술적 개념 이해하기](#기술적-개념-이해하기)
4. [설치 및 환경 설정](#설치-및-환경-설정)
5. [기본 동작 원리](#기본-동작-원리)
6. [프로젝트 진행 과정](#프로젝트-진행-과정)
7. [자주 묻는 질문](#자주-묻는-질문)

---

## PeopleNet이란 무엇인가요?

**PeopleNet**은 NVIDIA에서 개발한 인공지능 모델로, **사람을 자동으로 찾아내고 분석하는** 기능을 가진 프로그램입니다.

### 🤔 쉽게 말하면?
- 카메라로 찍은 영상이나 사진에서 **사람이 어디에 있는지** 자동으로 찾아줍니다
- 마치 사람의 눈처럼 "아, 여기 사람이 있구나!"라고 인식하는 기능입니다
- 컴퓨터가 사진을 보고 "이것은 사람이다"라고 판단할 수 있게 해주는 똑똑한 프로그램입니다

### 🎯 무엇을 할 수 있나요?
1. **사람 감지 (Person Detection)**: 이미지나 비디오에서 사람을 찾아냅니다
2. **바운딩 박스 생성**: 찾은 사람 주위에 네모난 상자를 그려줍니다
3. **실시간 처리**: 실시간으로 들어오는 영상에서도 사람을 찾을 수 있습니다
4. **신뢰도 측정**: 찾은 것이 얼마나 확실히 사람인지 점수로 알려줍니다

### 🏗️ NVIDIA TAO 툴킷의 일부
**TAO (Train, Adapt, Optimize)**는 NVIDIA에서 제공하는 AI 모델 개발 도구입니다.
- **Train**: 새로운 데이터로 학습시키기
- **Adapt**: 기존 모델을 다른 용도로 수정하기  
- **Optimize**: 더 빠르고 효율적으로 만들기

---

## 주요 기능과 활용 분야

### 🔍 주요 기능

#### 1. 사람 감지 (Person Detection)
**객체 감지(Object Detection)**의 특수한 형태로, 사람만을 찾아내는 기능입니다.
- **입력**: 사진 또는 비디오 파일
- **출력**: 사람이 있는 위치 정보 + 신뢰도 점수
- **처리 방식**: 한 번에 여러 사람을 동시에 찾을 수 있습니다

#### 2. 바운딩 박스 (Bounding Box) 생성
찾은 사람 주위에 그려지는 직사각형 상자입니다.
- **용도**: 사람이 있는 정확한 위치를 시각적으로 표시
- **정보**: 상자의 위치(x, y 좌표), 크기(너비, 높이) 포함
- **활용**: 사람이 움직이는 경로 추적이나 개수 계산에 사용

#### 3. 실시간 분석
- **실시간 스트리밍**: 카메라에서 들어오는 영상을 즉시 분석
- **배치 처리**: 여러 이미지를 한 번에 처리하여 효율성 향상
- **연속 처리**: 비디오의 모든 프레임을 순서대로 분석

#### 4. 신뢰도 점수 (Confidence Score)
AI가 얼마나 확신하는지를 0~1 사이의 숫자로 표현합니다.
- **0.9 이상**: 매우 확실함 (90% 이상 확률로 사람)
- **0.5-0.8**: 어느 정도 확실함
- **0.5 미만**: 불확실함 (보통 무시됨)

### 🏢 실제 활용 분야

#### 보안 및 감시 시스템
- **CCTV 모니터링**: 특정 구역에 사람이 들어왔는지 자동 감지
- **출입 통제**: 허가되지 않은 구역 접근 시 알림 발생
- **이상 행동 감지**: 평소와 다른 패턴의 움직임 감지
- **야간 감시**: 어두운 환경에서도 적외선 카메라와 함께 사용

#### 소매업 및 마케팅
- **고객 수 계산**: 매장에 들어오는 고객 수를 자동으로 세기
- **동선 분석**: 고객들이 매장에서 어느 구역을 많이 방문하는지 파악
- **대기 시간 측정**: 계산대나 특정 구역의 대기 인원 파악
- **피크 시간 분석**: 언제 가장 많은 고객이 방문하는지 데이터 수집

#### 스마트 시티 (Smart City)
- **교통 모니터링**: 횡단보도나 보행자 구역의 통행량 측정
- **공공 안전**: 위험 구역이나 공사 현장 근처 사람 감지
- **군중 밀도 분석**: 축제나 행사에서 사람들의 밀집도 파악
- **응급 상황 대응**: 사고 발생 시 현장 상황 빠른 파악

#### 헬스케어 및 의료
- **환자 모니터링**: 병실에서 환자의 움직임이나 상태 감지
- **낙상 감지**: 노인이나 환자의 넘어짐 사고 자동 감지
- **의료진 동선 파악**: 병원 내 의료진의 효율적인 이동 경로 분석
- **격리 구역 관리**: 감염병 상황에서 격리 구역 출입 관리

#### 교통 및 운송
- **보행자 안전**: 자율주행차의 보행자 감지 시스템
- **지하철/버스 승객 수**: 대중교통 이용객 수 파악
- **교통 신호 최적화**: 보행자 수에 따른 신호등 시간 조절
- **주차장 관리**: 주차장 내 사람의 움직임 모니터링

---

## 기술적 개념 이해하기

### 🧠 딥러닝 (Deep Learning)이란?
**딥러닝**은 컴퓨터가 사람의 뇌 구조를 모방하여 학습하는 방법입니다.

#### 기존 프로그래밍 vs 딥러닝
- **기존 방식**: 프로그래머가 모든 규칙을 직접 코딩
  - 예: "코가 있고, 눈이 2개 있고, 입이 있으면 사람이다"
- **딥러닝 방식**: 컴퓨터가 수많은 예시를 보고 스스로 규칙을 학습
  - 예: 백만 장의 사람 사진을 보여주고 특징을 스스로 찾게 함

#### 뉴럴 네트워크 (Neural Network)
사람의 뇌 신경세포를 모방한 구조입니다.
- **뉴런**: 정보를 처리하는 작은 단위
- **레이어**: 뉴런들이 층층이 쌓인 구조
- **깊은(Deep)**: 레이어가 많을수록 복잡한 패턴을 학습 가능

### 🎯 컴퓨터 비전 (Computer Vision)
컴퓨터가 이미지나 비디오를 이해하는 기술 분야입니다.

#### 주요 작업들
1. **이미지 분류**: "이 사진에 개가 있나요?"
2. **객체 감지**: "개가 어디에 있나요?"
3. **세그멘테이션**: "개의 정확한 윤곽선을 그려주세요"
4. **추적**: "이 개가 비디오에서 어떻게 움직이나요?"

#### PeopleNet의 위치
PeopleNet은 **객체 감지(Object Detection)** 기술에 속하며, 특히 사람만을 대상으로 특화된 모델입니다.

### 📦 바운딩 박스 (Bounding Box) 심화 이해
사람을 찾았을 때 그 위치를 표시하는 직사각형 상자입니다.

#### 바운딩 박스 정보
- **x, y**: 상자의 왼쪽 위 모서리 위치 (픽셀 단위)
- **width, height**: 상자의 너비와 높이 (픽셀 단위)
- **confidence**: 신뢰도 (0.0 ~ 1.0)
- **class**: 객체 종류 (PeopleNet에서는 항상 "사람")

#### 좌표계 이해
- **원점 (0,0)**: 이미지의 왼쪽 위 모서리
- **x축**: 오른쪽으로 갈수록 값이 증가
- **y축**: 아래쪽으로 갈수록 값이 증가

### 🔧 TensorRT란?
NVIDIA에서 개발한 **딥러닝 추론 가속화 라이브러리**입니다.

#### TensorRT의 역할
- **최적화**: AI 모델을 GPU에서 더 빠르게 실행되도록 변환
- **압축**: 모델 크기를 줄여서 메모리 사용량 감소
- **정밀도 조절**: 계산 정확도와 속도 간의 균형 조절

#### 정밀도 옵션
- **FP32**: 32비트 부동소수점 (가장 정확하지만 느림)
- **FP16**: 16비트 부동소수점 (속도와 정확도의 균형)
- **INT8**: 8비트 정수 (가장 빠르지만 정확도 약간 감소)

### 🎮 GPU vs CPU 처리
AI 모델 실행에서 GPU가 중요한 이유를 이해해봅시다.

#### CPU (Central Processing Unit)
- **특징**: 복잡한 계산을 순차적으로 처리
- **장점**: 복잡한 로직 처리에 뛰어남
- **단점**: 대량의 단순 계산에는 비효율적

#### GPU (Graphics Processing Unit)
- **특징**: 단순한 계산을 대량으로 병렬 처리
- **장점**: AI 모델의 행렬 연산에 최적화됨
- **단점**: 복잡한 로직 처리는 어려움

#### 왜 AI에 GPU가 필요한가?
AI 모델은 수백만 개의 단순한 곱셈과 덧셈을 동시에 수행해야 하므로, 병렬 처리가 뛰어난 GPU가 훨씬 효율적입니다.

---

## 설치 및 환경 설정

### 🔧 필요한 하드웨어

#### GPU 요구사항
- **최소 사양**: NVIDIA GTX 1060 (6GB VRAM)
- **권장 사양**: NVIDIA RTX 3060 이상 (8GB+ VRAM)
- **고성능**: NVIDIA RTX 4080/4090 (12GB+ VRAM)

#### 메모리 요구사항
- **시스템 RAM**: 8GB 이상 (16GB 권장)
- **GPU 메모리**: 4GB 이상 (8GB 권장)
- **저장공간**: 10GB 이상 여유 공간

#### 지원 플랫폼
- **Windows**: Windows 10/11 (64비트)
- **Linux**: Ubuntu 18.04/20.04/22.04
- **Embedded**: NVIDIA Jetson 시리즈

### 📦 필요한 소프트웨어

#### 1. NVIDIA 드라이버
GPU를 사용하기 위한 기본 드라이버입니다.
- **역할**: 운영체제와 GPU 간의 통신 담당
- **확인 방법**: 명령어 `nvidia-smi` 실행
- **업데이트**: NVIDIA 공식 웹사이트에서 최신 버전 다운로드

#### 2. CUDA Toolkit
GPU에서 범용 계산을 수행하기 위한 플랫폼입니다.
- **CUDA**: Compute Unified Device Architecture의 줄임말
- **역할**: GPU를 일반적인 계산 작업에 활용할 수 있게 해줌
- **버전**: PeopleNet과 호환되는 버전 확인 필요

#### 3. cuDNN (CUDA Deep Neural Network library)
딥러닝 연산에 특화된 라이브러리입니다.
- **역할**: 딥러닝에서 자주 사용되는 연산들을 GPU에서 빠르게 처리
- **최적화**: 컨볼루션, 풀링 등의 연산을 효율적으로 수행
- **라이선스**: NVIDIA 개발자 계정 필요

#### 4. TensorRT
AI 모델 추론을 가속화하는 라이브러리입니다.
- **버전 호환성**: CUDA 및 cuDNN 버전과 맞아야 함
- **설치 방법**: pip 또는 tar 파일로 설치 가능
- **라이선스**: 상업적 사용 시 라이선스 확인 필요

### 🔍 호환성 확인
각 소프트웨어 간의 버전 호환성이 매우 중요합니다.

#### 호환성 매트릭스
서로 다른 소프트웨어 버전들이 함께 작동하는지 확인하는 표입니다.
- **NVIDIA 공식 문서**: 정확한 호환 버전 조합 제공
- **커뮤니티 경험**: 실제 사용자들의 성공 사례 참고
- **테스트 필요**: 설치 후 반드시 동작 확인

### 🌐 개발 환경 선택

#### 로컬 개발 환경
자신의 컴퓨터에 직접 설치하는 방법입니다.
- **장점**: 완전한 제어권, 오프라인 작업 가능
- **단점**: 초기 설정 복잡, 하드웨어 요구사항 충족 필요

#### 클라우드 환경
온라인 서비스를 이용하는 방법입니다.
- **Google Colab**: 무료 GPU 제공 (시간 제한 있음)
- **AWS/GCP/Azure**: 유료이지만 고성능 GPU 사용 가능
- **NVIDIA NGC**: NVIDIA에서 제공하는 클라우드 서비스

#### 임베디드 환경
작은 컴퓨터에서 실행하는 방법입니다.
- **NVIDIA Jetson Nano**: 저전력, 저비용 옵션
- **NVIDIA Jetson Xavier**: 고성능 엣지 컴퓨팅
- **최적화 필요**: 제한된 자원에서 효율적 실행

---

## 기본 동작 원리

### 🔄 전체 처리 과정
PeopleNet이 사람을 감지하는 전체 과정을 단계별로 설명합니다.

#### 1단계: 입력 준비 (Input Preprocessing)
원본 이미지를 AI 모델이 처리할 수 있는 형태로 변환합니다.

**크기 조정 (Resizing)**
- **목적**: 모델이 학습된 크기와 일치시키기
- **일반적 크기**: 640x480, 416x416 등
- **방법**: 비율 유지하며 크기 조정 후 패딩 추가

**정규화 (Normalization)**
- **목적**: 픽셀 값을 0~1 범위로 변환
- **방법**: 각 픽셀값을 255로 나누기
- **추가 정규화**: 평균값 빼기, 표준편차로 나누기

**색상 공간 변환**
- **RGB vs BGR**: OpenCV는 BGR, 대부분 모델은 RGB 사용
- **채널 순서**: 높이-너비-채널 → 채널-높이-너비 순서 변경

#### 2단계: AI 모델 추론 (Inference)
전처리된 이미지를 AI 모델에 입력하여 예측 결과를 얻습니다.

**순전파 (Forward Pass)**
- **과정**: 입력 데이터가 뉴럴 네트워크의 모든 레이어를 통과
- **계산**: 수백만 개의 가중치와 편향을 이용한 행렬 연산
- **출력**: 각 위치에서 사람일 확률과 바운딩 박스 정보

**특징 추출 (Feature Extraction)**
- **저수준 특징**: 모서리, 색상, 질감 등
- **고수준 특징**: 얼굴, 몸체, 팔다리 등 사람의 형태
- **계층적 학습**: 레이어가 깊어질수록 복잡한 특징 학습

#### 3단계: 후처리 (Post-processing)
AI 모델의 원시 출력을 사용자가 이해할 수 있는 형태로 변환합니다.

**신뢰도 필터링**
- **임계값 적용**: 설정한 신뢰도보다 낮은 감지 결과 제거
- **예시**: 0.5 미만의 신뢰도를 가진 감지 결과 무시
- **조정 가능**: 환경에 따라 임계값 조정

**비최대 억제 (Non-Maximum Suppression, NMS)**
- **문제**: 같은 사람에 대해 여러 개의 바운딩 박스 생성
- **해결**: 겹치는 박스들 중 가장 신뢰도 높은 것만 선택
- **IoU 사용**: 박스 간 겹침 정도를 측정하여 중복 제거

**좌표 변환**
- **원래 크기로 복원**: 전처리에서 변경된 크기를 원본으로 되돌리기
- **좌표 계산**: 모델 출력 좌표를 실제 이미지 좌표로 변환

### 📊 성능 지표 이해

#### FPS (Frames Per Second)
1초 동안 처리할 수 있는 프레임(이미지) 수입니다.
- **실시간 기준**: 30 FPS 이상이면 실시간 처리 가능
- **영향 요소**: GPU 성능, 입력 해상도, 배치 크기
- **측정 방법**: 총 처리 시간을 프레임 수로 나누기

#### 정확도 (Accuracy)
모델이 사람을 올바르게 찾아내는 비율입니다.
- **정밀도 (Precision)**: 감지한 것 중 실제로 사람인 비율
- **재현율 (Recall)**: 실제 사람 중 감지한 비율
- **F1 점수**: 정밀도와 재현율의 조화평균

#### 메모리 사용량
모델 실행에 필요한 GPU 및 시스템 메모리 양입니다.
- **모델 크기**: 가중치 파라미터가 차지하는 메모리
- **배치 메모리**: 입력 데이터와 중간 결과 저장 공간
- **최적화**: TensorRT를 통한 메모리 사용량 최적화

### 🎛️ 설정 매개변수

#### 신뢰도 임계값 (Confidence Threshold)
감지 결과를 수용할 최소 신뢰도 수준입니다.
- **높은 값 (0.8~0.9)**: 확실한 것만 감지, 놓치는 경우 증가
- **낮은 값 (0.3~0.5)**: 더 많이 감지, 잘못된 감지 증가
- **권장값**: 0.5 (환경에 따라 조정)

#### NMS 임계값 (NMS Threshold)
중복 제거를 위한 IoU 임계값입니다.
- **높은 값 (0.7~0.9)**: 더 많은 박스 유지
- **낮은 값 (0.3~0.5)**: 더 적극적인 중복 제거
- **권장값**: 0.4~0.5

#### 입력 해상도
모델에 입력되는 이미지의 크기입니다.
- **고해상도**: 더 정확한 감지, 처리 시간 증가
- **저해상도**: 빠른 처리, 작은 객체 놓칠 가능성
- **일반적 선택**: 640x480 (정확도와 속도의 균형)

---





#### 📓 [0729_peoplenet.ipynb](0729_peoplenet.ipynb)  
#### 📄 [0730_nvidia_peoplenet.md](0730_nvidia_peoplenet.md)


---


Jupyter 노트북 형태의 단계별 학습 자료입니다:

**초보자 친화적 구성**
- **셀 단위 실행**: 코드를 작은 단위로 나누어 단계별 학습 가능
- **즉시 결과 확인**: 각 단계의 결과를 바로 시각화하여 이해도 향상
- **대화형 위젯**: 슬라이더, 버튼 등을 통한 실시간 매개변수 조정
- **에러 처리**: 일반적인 실수와 해결 방법 안내

**실습 중심 내용**
- **환경 설정**: 라이브러리 설치부터 모델 로딩까지 전 과정
- **샘플 테스트**: 제공된 이미지로 즉시 테스트 가능
- **실시간 데모**: 웹캠을 이용한 실시간 감지 체험
- **성능 분석**: 다양한 설정에 따른 성능 비교 실험

**시각화 및 분석**
- **결과 시각화**: Matplotlib을 이용한 그래프와 차트
- **비교 분석**: 여러 설정값에 따른 결과 비교
- **성능 측정**: 처리 시간, 정확도 등의 정량적 분석


---

## 자주 묻는 질문

### ❓ 하드웨어 관련 질문

**Q: GPU가 없어도 사용할 수 있나요?**
**A:** PeopleNet은 GPU 전용 모델입니다. CPU로는 실행할 수 없지만, 다음과 같은 대안이 있습니다:
- **Google Colab**: 무료로 GPU 사용 가능 (시간 제한 있음)
- **NVIDIA Jetson 나노**: 저렴한 GPU 개발 보드
- **클라우드 GPU 서비스**: AWS, GCP, Azure 등
