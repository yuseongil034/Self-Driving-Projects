# NVIDIA PeopleNet 초보자 가이드

## 📖 목차
1. [PeopleNet이란?](#peoplenet이란)
2. [주요 기능과 활용 분야](#주요-기능과-활용-분야)
3. [기술적 개념 이해](#기술적-개념-이해)
4. [설치 및 환경 설정](#설치-및-환경-설정)
5. [동작 원리](#동작-원리)
6. [자주 묻는 질문](#자주-묻는-질문)

---

## PeopleNet이란?

**PeopleNet**은 NVIDIA에서 개발한 AI 모델로, 이미지나 영상에서 사람을 자동으로 찾아내고 분석하는 프로그램입니다.

### 🤔 쉽게 말하면?
- 카메라로 찍은 영상이나 사진에서 **사람이 어디에 있는지** 자동으로 찾아줍니다
- 컴퓨터가 사진을 보고 "이것은 사람이다"라고 판단할 수 있게 해주는 똑똑한 프로그램입니다
- 마치 사람의 눈처럼 "아, 여기 사람이 있구나!"라고 인식하는 기능입니다

### 🎯 핵심 기능
| 기능 | 설명 |
|------|------|
| **사람 감지** | 이미지나 비디오에서 사람을 찾아냅니다 |
| **위치 표시** | 찾은 사람 주위에 네모난 상자(바운딩 박스)를 그려줍니다 |
| **실시간 처리** | 실시간으로 들어오는 영상에서도 사람을 찾을 수 있습니다 |
| **신뢰도 측정** | 찾은 것이 얼마나 확실히 사람인지 점수로 알려줍니다 |

### 🏗️ NVIDIA TAO 툴킷의 일부
**TAO (Train, Adapt, Optimize)**는 NVIDIA에서 제공하는 AI 모델 개발 도구입니다.
- **Train**: 새로운 데이터로 학습시키기
- **Adapt**: 기존 모델을 다른 용도로 수정하기  
- **Optimize**: 더 빠르고 효율적으로 만들기

---

## 주요 기능과 활용 분야

### 🔍 주요 기능 상세

#### 1. 사람 감지 (Person Detection)
**객체 감지**의 특수한 형태로, 사람만을 찾아내는 기능입니다.
- **입력**: 사진 또는 비디오 파일
- **출력**: 사람이 있는 위치 정보 + 신뢰도 점수
- **처리**: 한 번에 여러 사람을 동시에 찾을 수 있습니다

#### 2. 바운딩 박스 (Bounding Box)
찾은 사람 주위에 그려지는 직사각형 상자입니다.

**포함 정보**
- **위치**: x, y 좌표 (픽셀 단위)
- **크기**: 너비, 높이 (픽셀 단위)
- **신뢰도**: 0~1 사이의 확신 정도

#### 3. 신뢰도 점수 (Confidence Score)
AI가 얼마나 확신하는지를 숫자로 표현합니다.
- **0.9 이상**: 매우 확실함 (90% 이상 확률로 사람)
- **0.5-0.8**: 어느 정도 확실함
- **0.5 미만**: 불확실함 (보통 무시됨)

### 🏢 실제 활용 분야

#### 보안 및 감시
- CCTV 모니터링 자동화
- 출입 통제 시스템
- 이상 행동 감지
- 야간 감시 (적외선 카메라 연동)

#### 소매업 및 마케팅
- 고객 수 자동 계산
- 매장 내 고객 동선 분석
- 대기 시간 및 인원 측정
- 피크 시간 데이터 수집

#### 스마트 시티
- 교통량 및 보행자 통행량 측정
- 공공 안전 모니터링
- 군중 밀도 분석
- 응급 상황 대응 지원

#### 헬스케어
- 환자 모니터링
- 낙상 감지 시스템
- 의료진 동선 분석
- 격리 구역 관리

#### 교통 시스템
- 자율주행차 보행자 감지
- 대중교통 승객 수 파악
- 교통 신호 최적화
- 주차장 안전 관리

---

## 기술적 개념 이해

### 🧠 딥러닝 (Deep Learning)
컴퓨터가 사람의 뇌 구조를 모방하여 학습하는 방법입니다.

| 구분 | 기존 프로그래밍 | 딥러닝 |
|------|----------------|--------|
| **방식** | 프로그래머가 모든 규칙을 직접 코딩 | 컴퓨터가 예시를 보고 스스로 규칙 학습 |
| **예시** | "코, 눈 2개, 입이 있으면 사람" | 백만 장의 사람 사진으로 특징 자동 학습 |
| **장점** | 명확한 로직 | 복잡한 패턴 인식 가능 |

#### 뉴럴 네트워크 구조
- **뉴런**: 정보를 처리하는 작은 단위
- **레이어**: 뉴런들이 층층이 쌓인 구조
- **깊은(Deep)**: 레이어가 많을수록 복잡한 패턴 학습 가능

### 🎯 컴퓨터 비전 (Computer Vision)
컴퓨터가 이미지나 비디오를 이해하는 기술 분야입니다.

#### 주요 작업 유형
1. **이미지 분류**: "이 사진에 개가 있나요?"
2. **객체 감지**: "개가 어디에 있나요?" ← **PeopleNet은 여기**
3. **세그멘테이션**: "개의 정확한 윤곽선을 그려주세요"
4. **추적**: "이 개가 비디오에서 어떻게 움직이나요?"

### 🔧 핵심 기술 스택

#### TensorRT
NVIDIA에서 개발한 딥러닝 추론 가속화 라이브러리입니다.

**주요 기능**
- **최적화**: AI 모델을 GPU에서 더 빠르게 실행
- **압축**: 모델 크기를 줄여서 메모리 사용량 감소
- **정밀도 조절**: 계산 정확도와 속도 간의 균형 조절

**정밀도 옵션**
- **FP32**: 32비트 (가장 정확, 느림)
- **FP16**: 16비트 (속도와 정확도 균형)
- **INT8**: 8비트 (가장 빠름, 정확도 약간 감소)

#### GPU vs CPU
| 구분 | CPU | GPU |
|------|-----|-----|
| **특징** | 복잡한 계산을 순차 처리 | 단순한 계산을 대량 병렬 처리 |
| **AI 작업** | 비효율적 | AI 모델의 행렬 연산에 최적화 |
| **PeopleNet** | 지원 안함 | 필수 요구사항 |

---

## 설치 및 환경 설정

### 🔧 하드웨어 요구사항

#### GPU 사양
| 등급 | 모델 | VRAM | 용도 |
|------|------|------|------|
| **최소** | GTX 1060 | 6GB | 기본 테스트 |
| **권장** | RTX 3060 이상 | 8GB+ | 일반 개발 |
| **고성능** | RTX 4080/4090 | 12GB+ | 실시간 처리 |

#### 시스템 요구사항
- **시스템 RAM**: 8GB 이상 (16GB 권장)
- **저장공간**: 10GB 이상 여유 공간
- **OS**: Windows 10/11 (64비트), Ubuntu 18.04/20.04/22.04

### 📦 필수 소프트웨어 스택

#### 1. NVIDIA 드라이버
- **역할**: 운영체제와 GPU 간의 통신
- **확인 방법**: 터미널에서 `nvidia-smi` 실행
- **다운로드**: NVIDIA 공식 웹사이트

#### 2. CUDA Toolkit
- **역할**: GPU에서 범용 계산 수행
- **버전 호환성**: PeopleNet 지원 버전 확인 필요

#### 3. cuDNN
- **역할**: 딥러닝 연산 최적화
- **요구사항**: NVIDIA 개발자 계정 필요

#### 4. TensorRT
- **역할**: AI 모델 추론 가속화
- **설치**: pip 또는 tar 파일

### 🌐 개발 환경 선택

#### 로컬 환경
**장점**
- 완전한 제어권
- 오프라인 작업 가능

**단점**
- 복잡한 초기 설정
- 하드웨어 요구사항 충족 필요

#### 클라우드 환경
| 서비스 | 특징 | 비용 |
|--------|------|------|
| **Google Colab** | 무료 GPU 제공 | 무료 (시간 제한) |
| **AWS/GCP/Azure** | 고성능 GPU | 유료 |
| **NVIDIA NGC** | NVIDIA 공식 서비스 | 유료 |

#### 임베디드 환경
- **Jetson Nano**: 저전력, 저비용
- **Jetson Xavier**: 고성능 엣지 컴퓨팅

---

## 동작 원리

### 🔄 전체 처리 과정

#### 1단계: 입력 전처리 (Preprocessing)

**크기 조정 (Resizing)**
- 모델 학습 크기와 일치시키기 (일반적으로 640×480)
- 비율 유지하며 크기 조정 후 패딩 추가

**정규화 (Normalization)**
- 픽셀 값을 0~1 범위로 변환 (각 값을 255로 나누기)
- 평균값 빼기, 표준편차로 나누기

**색상 공간 변환**
- RGB ↔ BGR 변환 (OpenCV는 BGR, 대부분 모델은 RGB)
- 채널 순서 변경 (높이-너비-채널 → 채널-높이-너비)

#### 2단계: AI 모델 추론 (Inference)

**특징 추출 과정**
- **저수준**: 모서리, 색상, 질감
- **고수준**: 얼굴, 몸체, 팔다리 등 사람의 형태
- **계층적 학습**: 레이어가 깊어질수록 복잡한 특징 학습

**순전파 처리**
- 입력 데이터가 뉴럴 네트워크의 모든 레이어 통과
- 수백만 개 가중치와 편향을 이용한 행렬 연산
- 각 위치에서 사람일 확률과 바운딩 박스 정보 출력

#### 3단계: 후처리 (Post-processing)

**신뢰도 필터링**
- 설정한 임계값보다 낮은 감지 결과 제거
- 예: 0.5 미만 신뢰도 결과 무시

**비최대 억제 (NMS)**
- **문제**: 같은 사람에 대해 여러 바운딩 박스 생성
- **해결**: 겹치는 박스 중 가장 신뢰도 높은 것만 선택
- **IoU 사용**: 박스 간 겹침 정도 측정

**좌표 변환**
- 전처리에서 변경된 크기를 원본으로 복원
- 모델 출력 좌표를 실제 이미지 좌표로 변환

### 📊 성능 지표

#### FPS (Frames Per Second)
- **의미**: 1초당 처리 가능한 이미지 수
- **실시간 기준**: 30 FPS 이상
- **영향 요소**: GPU 성능, 해상도, 배치 크기

#### 정확도 측정
- **정밀도**: 감지한 것 중 실제 사람인 비율
- **재현율**: 실제 사람 중 감지한 비율
- **F1 점수**: 정밀도와 재현율의 조화평균

### 🎛️ 주요 설정 매개변수

#### 신뢰도 임계값 (Confidence Threshold)
| 값 범위 | 특징 | 권장 사용 |
|---------|------|-----------|
| **0.8~0.9** | 확실한 것만 감지, 놓치는 경우 증가 | 정확도 우선 |
| **0.5~0.7** | 균형적 감지 | 일반적 사용 |
| **0.3~0.4** | 더 많이 감지, 잘못된 감지 증가 | 민감도 우선 |

#### NMS 임계값
- **높은 값 (0.7~0.9)**: 더 많은 박스 유지
- **낮은 값 (0.3~0.5)**: 적극적인 중복 제거
- **권장값**: 0.4~0.5

#### 입력 해상도
- **고해상도**: 정확한 감지, 처리 시간 증가
- **저해상도**: 빠른 처리, 작은 객체 놓칠 가능성
- **일반적**: 640×480 (정확도와 속도 균형)

---

## 자주 묻는 질문

### ❓ 하드웨어 관련

**Q: GPU가 없어도 사용할 수 있나요?**
**A:** PeopleNet은 GPU 전용 모델입니다. CPU로는 실행할 수 없지만 다음 대안이 있습니다:
- **Google Colab**: 무료 GPU 사용 (시간 제한 있음)
- **NVIDIA Jetson 나노**: 저렴한 GPU 개발 보드
- **클라우드 서비스**: AWS, GCP, Azure 등

**Q: 얼마나 좋은 GPU가 필요한가요?**
**A:** 용도에 따라 다릅니다:
- **학습/테스트**: GTX 1060 (6GB) 이상
- **개발**: RTX 3060 (8GB) 이상 권장
- **실시간 처리**: RTX 4070 (12GB) 이상 권장

### ❓ 성능 관련

**Q: 실시간 처리가 가능한가요?**
**A:** GPU 성능과 설정에 따라 다릅니다:
- **RTX 3060**: 720p에서 30+ FPS
- **RTX 4080**: 1080p에서 60+ FPS
- **최적화**: TensorRT와 적절한 해상도 설정으로 성능 향상

**Q: 정확도를 높이려면 어떻게 해야 하나요?**
**A:** 다음 방법들을 시도해보세요:
- 신뢰도 임계값 높이기 (0.7~0.8)
- 입력 해상도 높이기
- 조명이 좋은 환경에서 사용
- 카메라 화질 개선

### ❓ 사용법 관련

**Q: 어떤 이미지 형식을 지원하나요?**
**A:** 일반적인 이미지 형식을 모두 지원합니다:
- **이미지**: JPG, PNG, BMP, TIFF
- **비디오**: MP4, AVI, MOV, MKV
- **실시간**: 웹캠, IP 카메라, RTSP 스트림

**Q: 여러 사람을 동시에 감지할 수 있나요?**
**A:** 네, 한 이미지에서 여러 사람을 동시에 감지할 수 있습니다. 감지할 수 있는 최대 인원수는 이미지 해상도와 사람 크기에 따라 달라집니다.

### ❓ 설치 및 설정

**Q: 설치 과정이 복잡한가요?**
**A:** 초기 설정은 다소 복잡할 수 있습니다:
- **Docker 사용**: 환경 설정을 단순화
- **사전 구성 이미지**: NVIDIA NGC에서 제공
- **단계별 가이드**: 공식 문서 참조 권장

**Q: 라이선스가 필요한가요?**
**A:** 
- **개발/연구**: 무료 사용 가능
- **상업적 사용**: NVIDIA 라이선스 정책 확인 필요
- **TensorRT**: 상업용 라이선스 별도 검토

---

---

## 📚 실습 자료

#### 📓 [0729_peoplenet.ipynb](0729_peoplenet.ipynb)  
#### 📄 [0730_nvidia_peoplenet.md](0730_nvidia_peoplenet.md)

---

**📚 추가 학습 자료**
- [NVIDIA TAO 공식 문서](https://docs.nvidia.com/tao/tao-toolkit/)
- [TensorRT 개발자 가이드](https://docs.nvidia.com/deeplearning/tensorrt/)
- [Computer Vision 기초 강의](https://www.coursera.org/learn/computer-vision-basics)
