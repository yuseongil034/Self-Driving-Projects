# 🚗 자율주행 영상 분석 파이프라인

> 5개의 AI 모델을 조합하여 도로 상황을 종합적으로 분석하는 지능형 시스템

---

## 📖 프로젝트 개요

### 🎯 프로젝트 목적

이 프로젝트는 **YouTube 영상**을 통해 자율주행 차량이 실제 도로에서 어떻게 주변 환경을 인식하는지 시뮬레이션하는 시스템입니다. 마치 사람이 운전할 때 눈으로 보고 판단하는 것처럼, AI가 영상을 분석하여 다음과 같은 것들을 자동으로 찾아냅니다:

- 🚗 **다른 차량들의 위치와 움직임**
- 🚶‍♂️ **보행자와 자전거 탑승자**
- 🚦 **신호등과 교통 표지판**
- 🛣️ **도로의 차선과 경계**
- 🏗️ **도로면과 주변 환경 구분**

### 💡 왜 이 프로젝트가 중요한가?

실제 자율주행 차량은 카메라, 라이다, 레이더 등 여러 센서를 사용하지만, **카메라를 통한 시각적 인식**이 가장 핵심적인 기술입니다. 이 프로젝트를 통해:

- 자율주행 기술의 **핵심 원리**를 이해할 수 있습니다
- 여러 AI 모델이 **협력하는 방식**을 학습할 수 있습니다
- **실제 도로 상황**에서의 AI 성능을 체험할 수 있습니다

---

## 🧠 사용된 AI 모델들

### 1️⃣ YOLO v11 - 범용 객체 탐지의 최강자

**YOLO**는 "You Only Look Once"의 줄임말로, 이미지를 한 번만 보고도 여러 객체를 동시에 찾아내는 혁신적인 기술입니다.

**🔍 주요 역할:**
- 자동차, 트럭, 버스 등 **모든 종류의 차량** 탐지
- 사람, 동물 등 **기본적인 객체들** 인식
- 전체적인 **교통 상황 파악**

**💪 특징:**
- **속도**: 실시간 처리 가능 (30fps 이상)
- **정확도**: 최신 버전(v11)으로 정밀도 대폭 향상
- **범용성**: 80여 개 일반 객체 클래스 지원

**🌟 실생활 예시:**
> 고속도로를 달리다가 앞차가 갑자기 차선을 변경할 때, YOLO가 그 차량을 즉시 인식하고 추적합니다.

---

### 2️⃣ PeopleNet - 보행자 안전의 전문가

**PeopleNet**은 사람과 자전거를 전문적으로 탐지하는 특화된 AI 모델입니다.

**🔍 주요 역할:**
- **보행자** 정밀 탐지 (어린이, 성인, 노인 구분 가능)
- **자전거 탑승자** 인식
- **보행자 행동 패턴** 분석 (걷기, 뛰기, 멈춤 등)

**💪 특징:**
- **안전 우선**: 보행자 보호에 특화된 높은 민감도
- **세밀한 구분**: 일반 객체 탐지보다 사람 인식에 특화
- **다양한 상황**: 밤낮, 날씨 관계없이 안정적 성능

**🌟 실생활 예시:**
> 스쿨존을 지날 때 갑자기 뛰어나오는 어린이를 미리 감지하여 자동 브레이크를 작동시킵니다.

---

### 3️⃣ TrafficNet - 교통 규칙의 해석사

**TrafficNet**은 도로의 모든 교통 관련 시설물을 이해하는 AI입니다.

**🔍 주요 역할:**
- **신호등** 상태 인식 (빨강, 노랑, 초록, 좌회전 등)
- **교통 표지판** 해석 (정지, 양보, 속도제한 등)
- **교차로** 구조 분석
- **도로 표시** 인식 (정지선, 횡단보도 등)

**💪 특징:**
- **규칙 준수**: 교통법규 자동 준수
- **상황 인식**: 복잡한 교차로 상황 이해
- **실시간 반응**: 신호 변화에 즉각 대응

**🌟 실생활 예시:**
> 교차로에서 좌회전 신호가 켜지면 이를 인식하고, 동시에 "좌회전 금지" 표지판도 확인하여 올바른 판단을 내립니다.

---

### 4️⃣ LaneNet - 차선의 마에스트로

**LaneNet**은 도로의 차선을 정밀하게 인식하고 차량의 정확한 주행 경로를 제시합니다.

**🔍 주요 역할:**
- **직선 차선** 및 **곡선 차선** 탐지
- **차선 변경** 구간 인식
- **도로 경계** 파악
- **주행 가능 영역** 계산

**💪 특징:**
- **곡선 처리**: 복잡한 커브길도 정확히 인식
- **날씨 대응**: 비나 눈이 와도 차선 추적 가능
- **거리 계산**: 차선과의 정확한 거리 측정

**🌟 실생활 예시:**
> 산길의 구불구불한 커브에서도 차선을 정확히 따라가며, 차선 변경이 필요한 구간을 미리 알려줍니다.

---

### 5️⃣ SegNet - 환경의 분석가

**SegNet**은 도로 환경을 픽셀 단위로 분석하여 각 영역이 무엇인지 구분합니다.

**🔍 주요 역할:**
- **도로면** 영역 구분
- **인도** 및 **보행 구역** 식별
- **건물**, **나무**, **하늘** 등 배경 분류
- **주행 가능 영역** 정밀 분석

**💪 특징:**
- **정밀 분할**: 픽셀 단위의 세밀한 영역 구분
- **환경 이해**: 전체적인 주변 환경 파악
- **안전 판단**: 주행 가능한 영역과 위험 영역 구분

**🌟 실생활 예시:**
> 공사 중인 도로에서 임시로 인도를 지나야 할 때, 어디까지가 안전한 주행 구역인지 정확히 파악합니다.

---

## 🔄 전체 파이프라인 흐름

### 단계 1: 📺 영상 입력 및 준비
```
사용자 입력 → YouTube URL + 시간 구간 설정
                ↓
        영상 자동 다운로드 및 클리핑
                ↓
        해상도 조정 및 프레임 추출
```

**📋 세부 과정:**
- 사용자가 분석하고 싶은 YouTube 영상 링크를 입력
- 원하는 시간 구간을 초 단위로 설정 (예: 30초~60초)
- 시스템이 자동으로 해당 영상을 다운로드
- 분석에 적합한 해상도로 자동 조정

---

### 단계 2: 🧠 AI 모델 동시 분석
```
입력 프레임 → 5개 모델 병렬 처리
               ↓
    ┌─────────┬─────────┬─────────┬─────────┐
    │  YOLO   │PeopleNet│TrafficNet│ LaneNet │ SegNet
    │ v11     │         │         │         │
    └─────────┴─────────┴─────────┴─────────┘
               ↓
         각 모델별 탐지 결과 생성
```

**📋 세부 과정:**
- 하나의 프레임이 5개 모델에 동시에 입력됩니다
- 각 모델이 자신의 전문 분야를 분석합니다
- 모든 처리가 병렬로 진행되어 속도를 최적화합니다
- 각 모델은 신뢰도와 함께 결과를 출력합니다

---

### 단계 3: 🔀 앙상블 처리 (결과 통합)
```
개별 모델 결과들 → 중복 제거 및 신뢰도 검증
                    ↓
              상황별 가중치 적용
                    ↓
             최종 통합 결과 생성
```

**📋 세부 과정:**
- **중복 제거**: 같은 객체를 여러 모델이 탐지한 경우 하나로 통합
- **신뢰도 검증**: 확실하지 않은 탐지 결과는 제외
- **상황별 조정**: 도심지에서는 보행자 탐지를 강화, 고속도로에서는 차량 탐지를 강화
- **충돌 해결**: 서로 다른 모델의 결과가 충돌할 때 우선순위 적용

---

### 단계 4: 🎨 시각화 및 결과 표시
```
통합된 탐지 결과 → 색상별 바운딩 박스 그리기
                   ↓
              신뢰도 및 라벨 표시
                   ↓
             정보 패널 오버레이
```

**📋 세부 과정:**
- **색상 구분**: 객체 종류별로 다른 색상의 박스로 표시
  - 🟡 차량: 노란색
  - 🔵 사람: 파란색  
  - 🔴 신호등: 빨간색
  - 🟢 차선: 초록색
- **정보 표시**: 각 객체의 이름과 신뢰도 퍼센트 표시
- **통계 패널**: 화면 상단에 실시간 통계 정보 표시

---

### 단계 5: 💾 결과 영상 생성 및 저장
```
시각화된 프레임들 → 영상 인코딩
                    ↓
              사용자 지정 이름으로 저장
                    ↓
             다운로드 링크 제공
```

**📋 세부 과정:**
- 모든 처리된 프레임을 하나의 영상 파일로 결합
- 원본과 같은 프레임률(FPS)로 부드러운 영상 생성
- 사용자가 지정한 파일명으로 저장
- Google Colab 환경에서는 자동 다운로드 제공

---

## ⚡ 성능 최적화 구조

### 🚀 실시간 처리를 위한 핵심 기술들

#### 1. **GPU 가속 처리**
- **CUDA 활용**: NVIDIA GPU의 수천 개 코어를 동시 활용
- **병렬 연산**: 여러 프레임을 동시에 처리
- **메모리 최적화**: GPU 메모리를 효율적으로 사용

#### 2. **TensorRT 최적화**
- **모델 경량화**: AI 모델의 크기를 줄이면서 성능 유지
- **정밀도 조정**: 32비트 → 16비트로 변환하여 속도 2배 향상
- **연산 융합**: 여러 계산 단계를 하나로 합쳐서 효율성 극대화

#### 3. **비동기 처리**
- **파이프라인**: 한 프레임을 처리하는 동안 다음 프레임 준비
- **멀티스레딩**: 5개 모델을 동시에 실행
- **메모리 풀링**: 메모리 할당/해제 시간 최소화

### 📊 성능 목표 및 달성 수준

| 성능 지표 | 목표 | 달성 예상 | 설명 |
|-----------|------|-----------|------|
| **처리 속도** | 30 FPS 이상 | 35-40 FPS | 실시간 영상 처리 가능 |
| **지연 시간** | 100ms 이하 | 80-90ms | 즉각적인 반응 속도 |
| **정확도** | 90% 이상 | 92-95% | 높은 신뢰도의 탐지 결과 |
| **GPU 메모리** | 8GB 이하 | 6-7GB | Google Colab에서 안정 실행 |

---

## 📚 초보자용 기술 용어 풀이

### 🤖 AI/딥러닝 용어

| 용어 | 설명 | 쉬운 예시 |
|------|------|-----------|
| **객체 탐지** | 이미지에서 특정 물체를 찾고 위치를 표시하는 기술 | 사진에서 사람 얼굴에 네모 박스 그리기 |
| **바운딩 박스** | 탐지된 객체 주위에 그리는 사각형 테두리 | 축구 경기에서 선수 주위의 네모 박스 |
| **신뢰도(Confidence)** | AI가 자신의 예측에 대해 얼마나 확신하는지 나타내는 수치 | "이것이 자동차일 확률 95%" |
| **앙상블** | 여러 AI 모델의 결과를 조합하여 더 정확한 답을 만드는 방법 | 5명이 각각 답을 말하고 가장 많은 답을 선택 |
| **NMS** | 같은 객체를 여러 번 탐지했을 때 가장 좋은 것만 남기는 기법 | 같은 사람에게 여러 개 박스가 그려졌을 때 하나만 남기기 |

### 💻 기술적 용어

| 용어 | 설명 | 쉬운 예시 |
|------|------|-----------|
| **FPS** | 1초에 처리할 수 있는 프레임(장면) 수 | 초당 30장의 사진을 분석 |
| **GPU** | 그래픽 처리 장치, AI 계산을 빠르게 수행 | 컴퓨터의 그래픽카드 |
| **CUDA** | NVIDIA GPU에서 계산을 빠르게 하는 기술 | GPU를 더 효율적으로 사용하는 방법 |
| **TensorRT** | AI 모델을 GPU에서 더 빠르게 실행하게 해주는 도구 | 프로그램 최적화 소프트웨어 |
| **병렬 처리** | 여러 작업을 동시에 수행하는 방식 | 5명이 각각 다른 일을 동시에 하기 |

### 🚗 자율주행 용어

| 용어 | 설명 | 쉬운 예시 |
|------|------|-----------|
| **차선 인식** | 도로의 흰색/노란색 선을 찾아내는 기술 | 사람이 운전할 때 차선을 보는 것과 같음 |
| **교통 표지판 인식** | 정지, 양보, 속도제한 등의 표지판을 읽는 기술 | 운전면허 시험에서 표지판 의미 파악 |
| **보행자 탐지** | 길을 걷는 사람들을 찾아내는 기술 | 횡단보도에서 사람이 건너는지 확인 |
| **실시간 처리** | 영상을 보는 즉시 분석하는 능력 | TV 생방송처럼 지연 없이 즉시 처리 |

---

## 🏗️ 전체 시스템 구조 요약

### 📊 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────┐
│                    사용자 인터페이스                         │
│              (YouTube URL + 시간 설정)                      │
└─────────────────────┬───────────────────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────────────────┐
│                  영상 전처리 시스템                          │
│        (다운로드 → 클리핑 → 프레임 추출)                     │
└─────────────────────┬───────────────────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────────────────┐
│                 AI 모델 앙상블 시스템                        │
│  ┌─────────┬─────────┬─────────┬─────────┬─────────┐       │
│  │ YOLO v11│PeopleNet│TrafficNet│ LaneNet │ SegNet  │       │
│  │  범용   │ 보행자  │ 교통시설│  차선   │ 도로분할│       │
│  └─────────┴─────────┴─────────┴─────────┴─────────┘       │
└─────────────────────┬───────────────────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────────────────┐
│                 결과 통합 시스템                            │
│          (중복 제거 → 신뢰도 검증 → 가중치 적용)             │
└─────────────────────┬───────────────────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────────────────┐
│                시각화 및 출력 시스템                         │
│        (바운딩 박스 → 라벨링 → 영상 합성)                   │
└─────────────────────────────────────────────────────────────┘
```

### 🎯 핵심 특징

#### ✨ **지능형 협업 시스템**
- 5개의 전문 AI가 각자의 역할을 수행하면서 서로 보완
- 하나의 모델이 놓친 것을 다른 모델이 찾아내는 구조
- 종합적이고 신뢰할 수 있는 분석 결과 제공

#### ⚡ **실시간 고속 처리**
- GPU 병렬 처리로 30fps 이상의 실시간 분석
- TensorRT 최적화로 지연시간 최소화
- 효율적인 메모리 관리로 안정적인 성능

#### 🔧 **사용자 친화적 설계**
- 복잡한 설정 없이 YouTube URL만으로 간단 실행
- Google Colab에서 별도 설치 없이 즉시 사용 가능
- 직관적인 시각화로 결과를 쉽게 이해

---

## 🌟 기대 효과 및 활용 분야

### 🎓 **교육적 가치**
- **자율주행 기술 이해**: 실제 기술의 작동 원리를 체험
- **AI 협업 학습**: 여러 모델이 함께 작업하는 방식 이해
- **컴퓨터 비전 실습**: 이론을 실제로 확인할 수 있는 기회

### 🔬 **연구 및 개발**
- **알고리즘 성능 비교**: 다양한 상황에서의 모델 성능 분석
- **데이터셋 검증**: 새로운 도로 환경에서의 AI 성능 테스트
- **안전성 평가**: 위험 상황에서의 AI 반응 속도 측정

### 🏭 **산업 응용**
- **자율주행 차량 개발**: 실제 자율주행 시스템의 프로토타입
- **교통 관리 시스템**: 도시 교통 상황 실시간 모니터링
- **안전 관리**: 위험 상황 자동 감지 및 경고 시스템

### 🎯 **실용적 시나리오**

#### 시나리오 1: 도시 교차로 분석
```
상황: 복잡한 도심 교차로의 교통 상황
분석 결과:
- 신호등 상태 인식 → 교통 흐름 제어
- 보행자 움직임 추적 → 안전 확보
- 차량 동선 파악 → 충돌 방지
```

#### 시나리오 2: 고속도로 주행 분석  
```
상황: 고속도로에서의 차선 변경 및 추월
분석 결과:
- 차선 정확한 인식 → 안전한 주행 경로
- 주변 차량 속도 분석 → 안전거리 확보
- 도로 표지판 해석 → 속도 제한 준수
```

#### 시나리오 3: 주택가 안전 운행
```
상황: 스쿨존이나 주택가 저속 주행
분석 결과:
- 어린이 보행자 우선 탐지 → 사고 예방
- 주차된 차량 인식 → 시야 확보
- 속도 제한 표지판 → 안전 속도 유지
```

---
[📁 0731_앙상블.ipynb](./0731_앙상블.ipynb)
---

## 🚀 시작하기

이 프로젝트를 통해 자율주행의 핵심 기술을 이해하고, AI가 어떻게 복잡한 도로 상황을 인식하는지 직접 확인해보세요!

**📝 다음 단계:**
1. 프로젝트 코드 다운로드
2. Google Colab에서 실행
3. 원하는 YouTube 영상으로 테스트
4. 결과 분석 및 성능 확인

**🤝 기여하기:**
- 새로운 모델 추가
- 성능 최적화 개선
- 다양한 도로 환경에서 테스트
- 문서 및 예시 개선

---

*이 프로젝트는 자율주행 기술의 교육적 목적으로 만들어졌습니다. 실제 자율주행 차량에는 더 많은 안전장치와 센서가 필요합니다.*
